{
    "sourceFile": "app/Http/Controllers/Main/PengelolaSaranaController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 14,
            "patches": [
                {
                    "date": 1705541984705,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1705542418544,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,11 +52,11 @@\n     {\n         $request->validate([\n             'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n-            'surat_id' => 'required',\n-            'pegawai' => 'required',\n+            'sarana_id' => 'required',\n             'keterangan' => 'required',\n+            'jumlah_unit' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n         // Proses pengunggahan berkas pertama\n@@ -64,36 +64,35 @@\n         $file1Name = time() . '_' . $file1->getClientOriginalName();\n         $file1->move(public_path('uploads'), $file1Name);\n \n \n-        $fileModel = new PengelolaanPersuratan();\n+        $fileModel = new PengelolaSarana();\n \n         $fileModel->user_id = $request->user_id;\n-        $fileModel->surat_id = $request->surat_id;\n-        $fileModel->pegawai =  json_encode($request->pegawai);\n+        $fileModel->sarana_id = $request->sarana_id;\n         $fileModel->keterangan = $request->keterangan;\n-        $fileModel->lampiran = $file1Name;\n+        $fileModel->unit = $file1Name;\n+        $fileModel->jumlah_unit = $request->jumlah_unit;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n-        $fileModel->pegawai = implode(\"+\", $request->pegawai);\n \n         $fileModel->save();\n-        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n+        return redirect('main/pengelola_sarana')->with('success', 'Data berhasil di simpan.');\n     }\n \n     /**\n      * Display the specified resource.\n      */\n     public function show(string $id)\n     {\n \n-        $row = PengelolaanPersuratan::findOrFail($id);\n-        return view('main.pengelolaan_persuratan.show', [\n-            'title' => 'Detail Data Pengelolaan Persuratan',\n-            'surat_id' => $row->surat_id,\n-            'pegawai' => $row->pegawai,\n+        $row = PengelolaSarana::findOrFail($id);\n+        return view('main.pengelola_sarana.show', [\n+            'title' => 'Detail Data Pengelola Sarana',\n+            'sarana_id' => $row->sarana_id,\n             'keterangan' => $row->keterangan,\n-            'lampiran' => $row->lampiran,\n+            'unit' => $row->unit,\n+            'jumlah_unit' => $row->jumlah_unit,\n             'tanggal' => $row->tanggal,\n         ]);\n     }\n \n@@ -102,18 +101,18 @@\n      */\n     public function edit(string $id)\n     {\n \n-        $row = PengelolaanPersuratan::findOrFail($id);\n+        $row = PengelolaSarana::findOrFail($id);\n         $user = User::all();\n-        $surat = Surat::all();\n-        return view('main.pengelolaan_persuratan.edit', [\n-            'title' => 'Edit Data Surat',\n+        $sarana = Sarana::all();\n+        return view('main.pengelola_sarana.edit', [\n+            'title' => 'Edit Data Sarana',\n             'user' => $user,\n             'id' => $row->id,\n-            'surat' => $surat,\n-            'pegawai' => $row->pegawai,\n+            'sarana' => $sarana,\n             'keterangan' => $row->keterangan,\n+            'jumlah_unit' => $row->jumlah_unit,\n             'tanggal' => $row->tanggal,\n             'status' => $row->status,\n         ]);\n     }\n@@ -128,8 +127,9 @@\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n             'keterangan' => 'required',\n+            'jumlah_unit' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n         // // Proses pengunggahan berkas pertama\n@@ -137,17 +137,18 @@\n         // $file1Name = time() . '_' . $file1->getClientOriginalName();\n         // $file1->move(public_path('uploads'), $file1Name);\n \n \n-        $fileModel = PengelolaanPersuratan::find($id);\n+        $fileModel = PengelolaSarana::find($id);\n         $fileModel->user_id = $request->user_id;\n         $fileModel->keterangan = $request->keterangan;\n+        $fileModel->jumlah_unit = $request->jumlah_unit;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n \n         $fileModel->save();\n \n-        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n+        return redirect('main/pengelola_sarana')->with('success', 'Data berhasil diubah');\n     }\n \n     /**\n      * Remove the specified resource from storage.\n"
                },
                {
                    "date": 1705542440536,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -155,9 +155,9 @@\n      */\n     public function destroy(string $id)\n     {\n \n-        $data = PengelolaanPersuratan::findOrFail($id);\n+        $data = PengelolaSarana::findOrFail($id);\n         $file_path = \"/uploads/\" . $data->lampiran;\n \n         if (file_exists($file_path)) {\n             @unlink($file_path);\n"
                },
                {
                    "date": 1705543788573,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,9 @@\n use App\\Models\\User;\n use Illuminate\\Http\\Request;\n use Illuminate\\Support\\Facades\\DB as FacadesDB;\n \n-class PengelolaanPersuratanController extends Controller\n+class PengelolaSaranaController extends Controller\n {\n     /**\n      * Display a listing of the resource.\n      */\n"
                },
                {
                    "date": 1705547958388,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,8 +54,9 @@\n             'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n             'sarana_id' => 'required',\n             'keterangan' => 'required',\n+            'unit' => 'required',\n             'jumlah_unit' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n"
                },
                {
                    "date": 1705548127022,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -157,9 +157,9 @@\n     public function destroy(string $id)\n     {\n \n         $data = PengelolaSarana::findOrFail($id);\n-        $file_path = \"/uploads/\" . $data->lampiran;\n+        $file_path = \"/uploads/\" . $data->unit;\n \n         if (file_exists($file_path)) {\n             @unlink($file_path);\n         }\n"
                },
                {
                    "date": 1705548600570,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,8 @@\n             'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n             'user_id' => 'required',\n             'sarana_id' => 'required',\n             'keterangan' => 'required',\n-            'unit' => 'required',\n             'jumlah_unit' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n         ]);\n"
                },
                {
                    "date": 1705733200433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -106,10 +106,12 @@\n         $user = User::all();\n         $sarana = Sarana::all();\n         return view('main.pengelola_sarana.edit', [\n             'title' => 'Edit Data Sarana',\n+            'user_id' => $row->user_id,\n             'user' => $user,\n             'id' => $row->id,\n+            'sarana_id' => $row->sarana_id,\n             'sarana' => $sarana,\n             'keterangan' => $row->keterangan,\n             'jumlah_unit' => $row->jumlah_unit,\n             'tanggal' => $row->tanggal,\n"
                },
                {
                    "date": 1705733446778,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,11 +108,11 @@\n         return view('main.pengelola_sarana.edit', [\n             'title' => 'Edit Data Sarana',\n             'user_id' => $row->user_id,\n             'user' => $user,\n-            'id' => $row->id,\n             'sarana_id' => $row->sarana_id,\n             'sarana' => $sarana,\n+            'id' => $row->id,\n             'keterangan' => $row->keterangan,\n             'jumlah_unit' => $row->jumlah_unit,\n             'tanggal' => $row->tanggal,\n             'status' => $row->status,\n"
                },
                {
                    "date": 1705733603125,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,11 +108,11 @@\n         return view('main.pengelola_sarana.edit', [\n             'title' => 'Edit Data Sarana',\n             'user_id' => $row->user_id,\n             'user' => $user,\n+            'id' => $row->id,\n             'sarana_id' => $row->sarana_id,\n             'sarana' => $sarana,\n-            'id' => $row->id,\n             'keterangan' => $row->keterangan,\n             'jumlah_unit' => $row->jumlah_unit,\n             'tanggal' => $row->tanggal,\n             'status' => $row->status,\n"
                },
                {
                    "date": 1705733616463,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -128,8 +128,9 @@\n             // 'file1' => 'required|mimes:jpg,png|max:5048',\n             // 'file2' => 'required|mimes:jpg,png|max:5048',\n             // 'file3' => 'required|mimes:jpg,png|max:5048',\n             'user_id' => 'required',\n+            'sarana_id' => 'required',\n             'keterangan' => 'required',\n             'jumlah_unit' => 'required',\n             'tanggal' => 'required',\n             'status' => 'required',\n"
                },
                {
                    "date": 1705733632747,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -142,8 +142,9 @@\n \n \n         $fileModel = PengelolaSarana::find($id);\n         $fileModel->user_id = $request->user_id;\n+        $fileModel->sarana_id = $request->sarana_id;\n         $fileModel->keterangan = $request->keterangan;\n         $fileModel->jumlah_unit = $request->jumlah_unit;\n         $fileModel->tanggal = $request->tanggal;\n         $fileModel->status = $request->status;\n"
                },
                {
                    "date": 1705985847414,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,23 +15,12 @@\n      * Display a listing of the resource.\n      */\n     public function index()\n     {\n-        if ($user = auth()->user()->jab_id == 4) {\n-            $user = auth()->user()->id;\n-            $data['title'] = 'Data pengelola sarana';\n-            $user = PengelolaSarana::with('users', 'sarana')\n-                ->where('user_id', $user)\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pengelola_sarana.index', $data);\n-        } else {\n-            $data['title'] = 'Data pengajuan pengelola sarana';\n-            $user = PengelolaSarana::with('users', 'sarana')\n-                ->get();\n-            $data['result'] = $user->sortDesc();\n-            return view('main.pengelola_sarana.index', $data);\n-        }\n+        $data['title'] = 'Data pengelola sarana';\n+        $user = PengelolaSarana::with('users', 'sarana')->get();\n+        $data['result'] = $user->sortDesc();\n+        return view('main.pengelola_sarana.index', $data);\n     }\n \n     /**\n      * Show the form for creating a new resource.\n"
                },
                {
                    "date": 1714010621805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,9 @@\n      * Display a listing of the resource.\n      */\n     public function index()\n     {\n-        $data['title'] = 'Data pengelola sarana';\n+        $data['title'] = 'Pengelola sarana';\n         $user = PengelolaSarana::with('users', 'sarana')->get();\n         $data['result'] = $user->sortDesc();\n         return view('main.pengelola_sarana.index', $data);\n     }\n"
                },
                {
                    "date": 1714010703036,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,9 @@\n      * Display a listing of the resource.\n      */\n     public function index()\n     {\n-        $data['title'] = 'Pengelola sarana';\n+        $data['title'] = 'Data Pengelola Sarana';\n         $user = PengelolaSarana::with('users', 'sarana')->get();\n         $data['result'] = $user->sortDesc();\n         return view('main.pengelola_sarana.index', $data);\n     }\n"
                }
            ],
            "date": 1705541984705,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers\\Main;\n\nuse App\\Http\\Controllers\\Controller;\nuse App\\Models\\Sarana;\nuse App\\Models\\PengelolaSarana;\nuse App\\Models\\User;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\DB as FacadesDB;\n\nclass PengelolaanPersuratanController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     */\n    public function index()\n    {\n        if ($user = auth()->user()->jab_id == 4) {\n            $user = auth()->user()->id;\n            $data['title'] = 'Data pengelola sarana';\n            $user = PengelolaSarana::with('users', 'sarana')\n                ->where('user_id', $user)\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pengelola_sarana.index', $data);\n        } else {\n            $data['title'] = 'Data pengajuan pengelola sarana';\n            $user = PengelolaSarana::with('users', 'sarana')\n                ->get();\n            $data['result'] = $user->sortDesc();\n            return view('main.pengelola_sarana.index', $data);\n        }\n    }\n\n    /**\n     * Show the form for creating a new resource.\n     */\n    public function create()\n    {\n        $data['user'] = User::all();\n        $data['sarana'] = Sarana::all();\n        $data['pengelola_sarana'] = PengelolaSarana::all();\n        $data['title'] = \"Tambah Data Pengelola Sarana\";\n        return view(\"main.pengelola_sarana.create\", $data);\n    }\n\n    /**\n     * Store a newly created resource in storage.\n     */\n    public function store(Request $request)\n    {\n        $request->validate([\n            'file1' => 'required|mimes:jpg,png,pdf|max:5048',\n            'user_id' => 'required',\n            'surat_id' => 'required',\n            'pegawai' => 'required',\n            'keterangan' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // Proses pengunggahan berkas pertama\n        $file1 = $request->file('file1');\n        $file1Name = time() . '_' . $file1->getClientOriginalName();\n        $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = new PengelolaanPersuratan();\n\n        $fileModel->user_id = $request->user_id;\n        $fileModel->surat_id = $request->surat_id;\n        $fileModel->pegawai =  json_encode($request->pegawai);\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->lampiran = $file1Name;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n        $fileModel->pegawai = implode(\"+\", $request->pegawai);\n\n        $fileModel->save();\n        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil di simpan.');\n    }\n\n    /**\n     * Display the specified resource.\n     */\n    public function show(string $id)\n    {\n\n        $row = PengelolaanPersuratan::findOrFail($id);\n        return view('main.pengelolaan_persuratan.show', [\n            'title' => 'Detail Data Pengelolaan Persuratan',\n            'surat_id' => $row->surat_id,\n            'pegawai' => $row->pegawai,\n            'keterangan' => $row->keterangan,\n            'lampiran' => $row->lampiran,\n            'tanggal' => $row->tanggal,\n        ]);\n    }\n\n    /**\n     * Show the form for editing the specified resource.\n     */\n    public function edit(string $id)\n    {\n\n        $row = PengelolaanPersuratan::findOrFail($id);\n        $user = User::all();\n        $surat = Surat::all();\n        return view('main.pengelolaan_persuratan.edit', [\n            'title' => 'Edit Data Surat',\n            'user' => $user,\n            'id' => $row->id,\n            'surat' => $surat,\n            'pegawai' => $row->pegawai,\n            'keterangan' => $row->keterangan,\n            'tanggal' => $row->tanggal,\n            'status' => $row->status,\n        ]);\n    }\n\n    /**\n     * Update the specified resource in storage.\n     */\n    public function update(Request $request, string $id)\n    {\n        $request->validate([\n            // 'file1' => 'required|mimes:jpg,png|max:5048',\n            // 'file2' => 'required|mimes:jpg,png|max:5048',\n            // 'file3' => 'required|mimes:jpg,png|max:5048',\n            'user_id' => 'required',\n            'keterangan' => 'required',\n            'tanggal' => 'required',\n            'status' => 'required',\n        ]);\n        // // Proses pengunggahan berkas pertama\n        // $file1 = $request->file('file1');\n        // $file1Name = time() . '_' . $file1->getClientOriginalName();\n        // $file1->move(public_path('uploads'), $file1Name);\n\n\n        $fileModel = PengelolaanPersuratan::find($id);\n        $fileModel->user_id = $request->user_id;\n        $fileModel->keterangan = $request->keterangan;\n        $fileModel->tanggal = $request->tanggal;\n        $fileModel->status = $request->status;\n\n        $fileModel->save();\n\n        return redirect('main/pengelolaan_persuratan')->with('success', 'Data berhasil diubah');\n    }\n\n    /**\n     * Remove the specified resource from storage.\n     */\n    public function destroy(string $id)\n    {\n\n        $data = PengelolaanPersuratan::findOrFail($id);\n        $file_path = \"/uploads/\" . $data->lampiran;\n\n        if (file_exists($file_path)) {\n            @unlink($file_path);\n        }\n        $data->delete();\n        return back()->with('hapus', 'Data sudah di Hapus!');\n    }\n}\n"
        }
    ]
}